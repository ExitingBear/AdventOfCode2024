---
title: "Day 11 Notebook"
output: html_notebook
---

```{r setup, include=FALSE}
library(knitr)
library(dplyr)
library(stringr)
library(tidyverse)
library(readr)
library(collections)
options(scipen = 999)
```

## Part 1
I know this is wrong, and yet - here goes the brute force attempt

```{r}
blink<-function(n,r){
  while(r>0){
    n<-sapply(n,function(x){
      if(x==0){y<-1
      }else if(nchar(x)%%2==0){
        d<-nchar(x)/2
        y<-c(as.numeric(str_sub(x,end=d)),as.numeric(str_sub(x,start=d+1)))
      }else{y<-x*2024}
      y})
    ### needed because splitting in two stones turns it
    ### into a matrix for reasons I do not understand  this stops that.
    n<-unlist(n)
    r<-r-1}
  length(n)}
```


```{r}
part1<-blink(c(125,17),25)
part1
```

## Part 2

damn lanternfish

```{r}
blinkinglanternfish<-function(r,n){
  ### first, change n into a df
    n<-as.data.frame(cbind(n,rep(1,length(n))))
    colnames(n)<-c("val","cnt")
    while(r>0){
    nxt<-as.data.frame(matrix(nrow=0,ncol=2))
    for(i in 1:nrow(n)){
      if(n$val[i]==0){
        nxt<-rbind(nxt,c(1,n$cnt[i]))
      }else if(nchar(n$val[i])%%2==0){
        d<-nchar(n$val[i])/2
        a<-as.numeric(str_sub(n$val[i],end=d))
        b<-as.numeric(str_sub(n$val[i],start=d+1))
        nxt<-rbind(nxt,c(a,n$cnt[i]))
        nxt<-rbind(nxt,c(b,n$cnt[i]))
      }else{
        nxt<-rbind(nxt,c(n$val[i]*2024,n$cnt[i]))}
    ### change the column names
    colnames(nxt)<-c("val","cnt")}
    ### summarize the columns
    n<-nxt%>% group_by(val)%>%summarise(cnt=sum(cnt))
    r<-r-1}
stones<-sum(n$cnt)
stones}
  
  
```

```{r}
part2<-blinkinglanternfish(75,c(125,17))
part2
```